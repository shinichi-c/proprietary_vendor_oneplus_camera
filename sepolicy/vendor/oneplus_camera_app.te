app_domain(oneplus_camera_app)
app_domain(oneplus_camera_service_app)
app_domain(oneplus_gallery_app)

net_domain(oneplus_camera_app)
net_domain(oneplus_gallery_app)

typeattribute oneplus_camera_app coredomain;
typeattribute oneplus_camera_service_app coredomain;
typeattribute oneplus_gallery_app coredomain;

typeattribute oneplus_camera_app hal_camera_client;
#typeattribute oneplus_camera_app hal_param_client; [technically it WANTS this, but you'd have to build it into oneplus-fwk to stop the flood of java.lang.IllegalArgumentException warnings]

hal_client_domain(oneplus_camera_app, vendor_hal_dspmanager)
#hal_client_domain(oneplus_camera_app, hal_camera)
hal_client_domain(oneplus_camera_app, hal_cameraHIDL)
hal_client_domain(oneplus_camera_app, hal_perf)

allow oneplus_camera_app hal_cameraHIDL_hwservice:hwservice_manager find;
allow oneplus_camera_app hal_perf_hwservice:hwservice_manager find;
allow oneplus_camera_app vendor_hal_dspmanager_hwservice:hwservice_manager find;

binder_call(oneplus_camera_app, hal_camera_default)
binder_call(oneplus_camera_app, hal_cameraHIDL_default)
binder_call(oneplus_camera_app, hal_perf_default)

allow oneplus_camera_app adsprpcd_file:dir r_dir_perms;

allow oneplus_camera_app sysfs_battery_supply:dir r_dir_perms;
allow oneplus_camera_app sysfs_battery_supply:file rw_file_perms;

allow oneplus_camera_app sysfs_net:dir search;
allow oneplus_camera_app sysfs_net:file { open read };

allow oneplus_camera_app system_data_file:dir getattr;

allow oneplus_camera_app vendor_camera_update_data_file:dir rw_dir_perms;
allow oneplus_camera_app vendor_camera_update_data_file:file create_file_perms;

r_dir_file(oneplus_camera_app, vendor_persist_camera_file)

allow oneplus_camera_app {
  activity_service
  activity_task_service
  audio_service
  audioserver_service
  autofill_service
  batteryproperties_service
  batterystats_service
  cameraserver_service
  clipboard_service
  content_capture_service
  device_state_service
  game_service
  gpu_service
  hint_service
  legacy_permission_service
  location_service
  media_communication_service
  media_session_service
  mediaextractor_service
  mediametrics_service
  mediaserver_service
  netstats_service
  nfc_service
  package_native_service
  radio_service
  sensitive_content_protection_service
  sensorservice_service
  shortcut_service
  surfaceflinger_service
  textservices_service
  thermal_service
  trust_service
  uimode_service
  usb_service
  virtual_device_native_service
  voiceinteraction_service
  wifi_service
  window_service
}:service_manager find;

allow oneplus_gallery_app {
  activity_service
  activity_task_service
  audio_service
  audioserver_service
  autofill_service
  batteryproperties_service
  batterystats_service
  cameraserver_service
  clipboard_service
  content_capture_service
  gpu_service
  legacy_permission_service
  location_service
  mediaextractor_service
  mediaserver_service
  media_session_service
  mediametrics_service
  netstats_service
  nfc_service
  radio_service
  sensitive_content_protection_service
  thermal_service
  trust_service
  uimode_service
  usb_service
  vibrator_manager_service
  voiceinteraction_service
  webviewupdate_service
  wifi_service
  window_service
}:service_manager find;

get_prop(oneplus_camera_app, ctl_default_prop)
get_prop(oneplus_camera_app, vendor_persist_camera_prop)

allow oneplus_gallery_app privapp_data_file:dir { getattr search };
allow oneplus_gallery_app privapp_data_file:file { open execute };

allow oneplus_gallery_app system_data_file:dir getattr;

get_prop(oneplus_gallery_app, aac_drc_prop)
get_prop(oneplus_gallery_app, adaptive_haptics_prop)

dontaudit oneplus_camera_app default_android_service:service_manager find;
dontaudit oneplus_gallery_app default_android_service:service_manager find;
